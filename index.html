<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Outlier Reconstruction Web Demo</title>

  <link rel="stylesheet" href="style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"></script>

</head>

<body onload="init(), loadModel()">

  <div class="title">
    <p id="title">Outlier Reconstruction</p>
    <p id="subtitle">Demo coded by <a id="namelink" href="mailto: junhr99@naver.com">Hyerim Jeon</a>
      and <a id="namelink" href="https://swyoon.github.io/">Sangwoong Yoon</a>.
    </p>
  </div>
  <br>
  <div class="container">
    <span id="para">
      Intro
    </span>
    </br></br>

    <div class="row">
      <p>
        <b>Outlier reconstruction</b> is a phenomenon that an autoencoder (AE) successfully reconstructs an outlier.
        In the demo below, we demonstrate that AE trained on MNIST is capable of reconstrcting diverse images that are
        clearly not MNIST.
        Outlier reconstruction is detrimental for an autoencoder-based outlier detector,
        as the reconstructed outliers will be misclassified as an inlier.
      </p>
      <p>
        In our <a href="https://arxiv.org/abs/2105.05735">ICML 2021 paper</a>,
        we propose a novel autoencoder called <b>Normalized Autoencoder (NAE)</b> where AE is interpreted as an
        energy-based model by setting the reconstruction error as the energy function.
        The outlier reconstruction is naturally suppresed in NAE through the enforcement of the normalization
        constraint.
      </p>
    </div>
    </br>
    <span id="para">
      Demo
    </span>
    </br></br>
    <div class="row">
      <div class="parent">
        <div id="canvastitle" class="first">Input</div>
        <div id="canvastitle" class="second">AE Reconstruction</div>
        <div id="canvastitle" class="third">NAE Reconstruction</div>

        <div class="first">
          <canvas width="28" height="28" id="Inputcanvas"></canvas>
        </div>

        <div class="second">
          <canvas width="28" height="28" id="AEcanvas"></canvas>
        </div>

        <div class="third">
          <canvas width="28" height="28" id="NAEcanvas"></canvas>
        </div>
      </div>

      <div class="parent">
        <div class="first">
          <button id="canvasbutton" class="btn btn-primary btn-sm"
            onclick="javascript:clearArea();return false;">Clear</button>
          <button id="canvasbutton" class="btn btn-primary btn-sm"
            onclick="javascript:make_prediction();return false;">Run</button>
          </br>
        </div>

        <div class="second">
          <span>
            Reconstuct Error:
          </span>
          <input type="text" id="AErecon">

        </div>
        <div class="third">
          <span>
            Reconstuct Error:
          </span>
          <input type="text" id="NAErecon">
        </div>
      </div>
    </div>
  </div>
  </br>

  <div class="container">

    <span id="presettitle">Preset Inputs</span>
    <div id="preset" class="row">
      <div class="preset_btn">
        <span id=presetsubtitle>Inlier Inputs</span></br>
        <button type="button" id="mnist3_btn" onclick="javascript:load_image('mnist_3.jpg');return false;">
          <img src="./preset_image/mnist_3.jpg"></button>

        <button type="button" id="mnist5_btn" onclick="javascript:load_image('mnist_5.jpg');return false;">
          <img src="./preset_image/mnist_5.jpg"></button>

        <button type="button" id="mnist7_btn" onclick="javascript:load_image('mnist_7.jpg');return false;">
          <img src="./preset_image/mnist_7.jpg"></button>
      </div>

      </br></br></br>

      <div class="preset_btn">
        <span id="presetsubtitle">Outlier Inputs</span></br>
        <button type="button" id="omniglot1_btn" onclick="javascript:load_image('omniglot1.jpg');return false;">
          <img src="./preset_image/omniglot1.jpg"></button>

        <button type="button" id="omniglot2_btn" onclick="javascript:load_image('omniglot2.jpg');return false;">
          <img src="./preset_image/omniglot2.jpg"></button>

        <button type="button" id="fashionmnist1_btn" onclick="javascript:load_image('fashionmnist1.jpg');return false;">
          <img src="./preset_image/fashionmnist1.jpg"></button>

        <button type="button" id="fashionmnist2_btn" onclick="javascript:load_image('fashionmnist2.jpg');return false;">
          <img src="./preset_image/fashionmnist2.jpg"></button>
      </div>
    </div>
  </div>

  </br></br>

  <div class="container">
    <span id="para">
      Info
    </span>
    </br></br>
    <div class="row">
      <p>
        To learn more about outlier reconstruction and NAE, please check out our paper
        <a href="https://arxiv.org/abs/2105.05735">Autoencoding Under Normalization Constraint (Yoon, Noh, and Park,
          2021)</a>.
        If you want to cite outlier reconstruction, NAE, or the demo, please use the following bibtex:
      </p>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <pre style="background-color: #eee; border: 1px solid #999">
    @InProceedings{yoon21autoencoding,
      title = 	 {Autoencoding Under Normalization Constraints},
      author =       {Yoon, Sangwoong and Noh, Yung-Kyun and Park, Frank},
      booktitle = 	 {Proceedings of the 38th International Conference on Machine Learning},
      pages = 	 {12087--12097},
      year = 	 {2021},
      editor = 	 {Meila, Marina and Zhang, Tong},
      volume = 	 {139},
      series = 	 {Proceedings of Machine Learning Research},
      month = 	 {18--24 Jul},
      publisher =    {PMLR},}</pre>
    </div>
  </div>

  <script src="canvas.js"></script>
  <script src="model.js"></script>

</body>

</html>